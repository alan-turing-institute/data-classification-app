{% extends "base.html" %}
{% load project_tags %}
{% load django_tables2 %}


{% block h1_title %}Data Classification for {{ work_package.name }}{% endblock %}

{% block content %}

{% if classification %}
  <p>You ({{ classification.created_by }}, {{classification.role|project_role_display}}) have classified this project as Tier {{ classification.tier }}</p>
{% endif %}

<h2>Overall classification</h2>
{% if work_package.has_tier %}
  <p>Classification is complete: Work package is tier {{ work_package.tier }}</p>
{% elif not work_package.is_classification_ready %}
  <p>Classification pending:</p>
  <ul>
    {% for reason in work_package.missing_classification_requirements %}
      <li>{{ reason }}</li>
    {% endfor %}
  </ul>
{% elif work_package.tier_conflict %}
  <p>Users disagree on data tier</p>
{% endif %}

{% if not work_package.has_tier and other_classifications.exists %}
  <p>Classifications by other users:</p>
  <ul>
  {% for cl in other_classifications %}
    <li>{{ cl.created_by }} ({{cl.role|project_role_display}}) classified the project as Tier {{ cl.tier }}</li>
  {% endfor %}
  </ul>
{% endif %}

{% if questions_table %}
  <h2>Classification answers</h2>
  {% if classification %}
    <p>You may modify your answers until overall classification has been completed. If you wish to do so, please use the links below. If you wish to delete your answers and start again, use the button at the bottom of the table.</p>
  {% endif %}
  {% render_table questions_table %}
  {% if classification %}
    <p><a class="btn btn-primary btn-lg" href="{% url 'projects:classify_delete' work_package.project.id work_package.id %}">Delete My Classification</a></p>
  {% endif %}
{% endif %}

{% endblock content %}

{% block crumbs %}
  <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
  <li class="breadcrumb-item"><a href="{% url 'projects:list' %}">Projects</a></li>
  <li class="breadcrumb-item"><a href="{% url 'projects:detail' work_package.project.id %}">{{ work_package.project.name }}</a></li>
  <li class="breadcrumb-item">Work Packages</li>
  <li class="breadcrumb-item"><a href="{{ work_package.get_absolute_url }}">{{ work_package.name }}</a></li>
  <li class="breadcrumb-item active" aria-current="page">Data Classification</li>
{% endblock crumbs %}
