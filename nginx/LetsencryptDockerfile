FROM nginx:1.21-alpine

# removes default conf so that custom nginx.conf can be used
RUN rm /etc/nginx/conf.d/default.conf
COPY letsencrypt.conf /etc/nginx/conf.d/default.conf.template

# run entrypoint to add BASE_DOMAIN to template
COPY letsencrypt-entrypoint.sh /
ENTRYPOINT [ "/letsencrypt-entrypoint.sh" ]
CMD ["nginx", "-g", "daemon off;"]

